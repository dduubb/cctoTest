<!DOCTYPE html>
<html>
    <head>
        <title>getData() Basic Example</title>
		<script type="text/javascript" src="https://public.tableau.com/javascripts/api/tableau-2.min.js"></script>
        <script type="text/javascript">
            var viz, sheet, table;
 
            function initViz() {
				var containerDiv = document.getElementById("vizContainer"),
							url = "https://public.tableau.com/views/wenarow958uewihfsdiouyf0e9r7859384cx/HistoricTotal?:language=en-US&:display_count=n&:origin=viz_share_link",
							options = {
								hideTabs: false,
								hideToolbar: true,
								onFirstInteractive: function () {
									document.getElementById('getData').disabled = false; // Enable our button
								}
							};
						viz = new tableau.Viz(containerDiv, url, options);
					}
 
			function querySheets() {
			  activeBook = viz.getWorkbook()
			  activeSheet = viz.getWorkbook().getActiveSheet();;
			  worksheets = activeSheet.getWorksheets();
			  for(i=0;i<worksheets.length;i++)
			  {
				console.log(activeBook);//;
                //console.log(worksheets[i].getName()); 
			  }
			  //console.log(worksheets);
			}
        </script>
    </head>
 
    <body onload="initViz();">
        <div class="page-header">
            <button id="getData" onclick="querySheets()" class="btn" disabled>Get Sheet Names</button>
        </div>
        <div id="vizContainer" style="width:100%; height:600px;"></div>
    </body>
</html>
